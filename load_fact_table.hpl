<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>load_fact_table</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <pipeline_status>0</pipeline_status>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2020/04/27 10:17:26.782</created_date>
    <modified_user>-</modified_user>
    <modified_date>2020/04/27 10:17:26.782</modified_date>
    <key_for_session_key>H4sIAAAAAAAA/wMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>Status

zur prüfung offen
in arbeit
in bearbeitung P.
in bearbeitung F.</note>
      <xloc>496</xloc>
      <yloc>1648</yloc>
      <width>158</width>
      <heigth>130</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>Korrektur
Rückfragen
Korrektur + Rückfragen
Plausible
</note>
      <xloc>512</xloc>
      <yloc>1488</yloc>
      <width>209</width>
      <heigth>110</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>Anzahl Rechnungen</note>
      <xloc>496</xloc>
      <yloc>976</yloc>
      <width>179</width>
      <heigth>30</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>Anzahl geprüfter Rechnungen</note>
      <xloc>672</xloc>
      <yloc>1056</yloc>
      <width>264</width>
      <heigth>30</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>Anzahl freigegebener Rechnungen</note>
      <xloc>672</xloc>
      <yloc>1136</yloc>
      <width>303</width>
      <heigth>30</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>Anzahl nach deadline_farbe</note>
      <xloc>848</xloc>
      <yloc>1360</yloc>
      <width>245</width>
      <heigth>30</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>-- noch nicht geprüft
'new',
'assigned',
'in_progress',
 'missing_data',
'reopened',

--Zur Prüfung freigegeben
'in_approval',
'pending_approval',

'pending',-- zwischenstatus

'send_to_requirement_holder', --(nicht geprüt und nicht freigegeben)
'changed',

-- erledigt
'approved',
'done',</note>
      <xloc>848</xloc>
      <yloc>1616</yloc>
      <width>599</width>
      <heigth>390</heigth>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
    <notepad>
      <note>DONT UPDATE TEAM_NAME von z.B erster Prüfer
DWH-1020 DWH-2084 DWH-2074</note>
      <xloc>544</xloc>
      <yloc>2352</yloc>
      <width>344</width>
      <heigth>50</heigth>
      <fontname>Cantarell</fontname>
      <fontsize>11</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
    </notepad>
  </notepads>
  <order>
    <hop>
      <from>reviewed_date_sid &lt;&gt; 0</from>
      <to>count_reviewed_invoices 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>reviewed_date_sid &lt;&gt; 0</from>
      <to>count_reviewed_invoices 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>approved_date_sid &lt;&gt; 0</from>
      <to>count_approved_invoices 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>approved_date_sid &lt;&gt; 0</from>
      <to>count_approved_invoices 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count_approved_invoices 1</from>
      <to>Switch / case</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count_approved_invoices 0</from>
      <to>Switch / case</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count red</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count blue</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count white</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count 0</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count white</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count blue</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count red</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count_reviewed_invoices 1</from>
      <to>approved_date_sid &lt;&gt; 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count_reviewed_invoices 0</from>
      <to>approved_date_sid &lt;&gt; 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count_invoices</from>
      <to>reviewed_date_sid &lt;&gt; 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>union</from>
      <to>Formula</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Get variables</from>
      <to>If measure value is null replace by 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case 2</from>
      <to>count zur Prüfung offen</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case 2</from>
      <to>count in Arbeit</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case 2</from>
      <to>count 0 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count in Arbeit</from>
      <to>union 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count zur Prüfung offen</from>
      <to>union 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count 0 2</from>
      <to>union 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>If sid value is null</from>
      <to>Sort rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort rows</from>
      <to>Sorted merge</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sorted merge</from>
      <to>Add value fields changing sequence</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add value fields changing sequence</from>
      <to>Group by</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Group by</from>
      <to>count_invoices</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>trash should not have rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>union 2</from>
      <to>Filter rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count yellow</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count orange</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count yellow</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count orange</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Formula</from>
      <to>Switch / case 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>If measure value is null replace by 0</from>
      <to>Table output fact_invoice_clearances</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>union</from>
      <to>Modified JavaScript value</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>l3_baus.invoice_clearances</from>
      <to>approver_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>approver_sid</from>
      <to>companies_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>companies_sid</from>
      <to>craft_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>craft_sid</from>
      <to>deadline_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim_requirement_holder_groups_sid</from>
      <to>requirement_holder_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>requirement_holder_sid</from>
      <to>reviser_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>reviser_sid</from>
      <to>sap_invoice_numbers_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>sap_invoice_numbers_sid</from>
      <to>state_sid 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>state_sid 2</from>
      <to>approved_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>approved_date_sid</from>
      <to>due_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>due_date_sid</from>
      <to>entry_ma06_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>entry_ma06_date_sid</from>
      <to>erp_import_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>erp_import_date_sid</from>
      <to>first_approved_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>invoice_date_sid</from>
      <to>last_approved_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>last_invoice_document_requested_date_sid</from>
      <to>last_reopened_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>reviewed_date_sid</from>
      <to>state_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>remove fields</from>
      <to>If sid value is null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>deadline_sid</from>
      <to>dim_requirement_holder_groups_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>dynamic Dimension on Measure-Values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dynamic Dimension on Measure-Values</from>
      <to>Get variables</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Modified JavaScript value</from>
      <to>Switch / case 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>last_reopened_date_sid</from>
      <to>reviewed_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>first_approved_date_sid</from>
      <to>first_return_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>first_return_date_sid</from>
      <to>first_reviewed_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>first_reviewed_date_sid</from>
      <to>invoice_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>state_date_sid</from>
      <to>first_approver_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>last_approved_date_sid</from>
      <to>order_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>order_date_sid</from>
      <to>last_invoice_document_requested_date_sid</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>truncate table restart sid</from>
      <to>Block this step until steps finish</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Block this step until steps finish</from>
      <to>Blocking step</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Blocking step</from>
      <to>l3_baus.invoice_clearances</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>first_approver_sid</from>
      <to>approver_historic_team</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>approver_historic_team</from>
      <to>reviser_historic_team</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>reviser_historic_team</from>
      <to>remove fields</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>count green</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>count green</from>
      <to>union</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Add value fields changing sequence</name>
    <type>FieldsChangeSequence</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>sap_invoice_number</name>
      </field>
    </fields>
    <increment>1</increment>
    <resultfieldName>row_per_invoice</resultfieldName>
    <start>1</start>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>784</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Block this step until steps finish</name>
    <type>BlockUntilTransformsFinish</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <transforms>
      <transform>
        <CopyNr>0</CopyNr>
        <name>truncate table restart sid</name>
      </transform>
    </transforms>
    <attributes/>
    <GUI>
      <xloc>368</xloc>
      <yloc>48</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Blocking step</name>
    <type>BlockingTransform</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>5000</cache_size>
    <compress>Y</compress>
    <directory>%%java.io.tmpdir%%</directory>
    <pass_all_rows>Y</pass_all_rows>
    <prefix>block</prefix>
    <attributes/>
    <GUI>
      <xloc>576</xloc>
      <yloc>48</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Filter rows</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>dynamic Dimension on Measure-Values</send_true_to>
    <send_false_to>trash should not have rows</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>row_per_invoice</leftvalue>
        <function>=</function>
        <rightvalue>max_row_per_invoice</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>2032</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Formula</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formulas>
</formulas>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1520</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Get variables</name>
    <type>GetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>dwh_batch_id</name>
        <variable>${BATCH_ID}</variable>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>2208</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Group by</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <add_linenr>N</add_linenr>
    <ignore_aggregate>N</ignore_aggregate>
    <fields>
      <field>
        <aggregate>max_row_per_invoice</aggregate>
        <subject>sap_invoice_number</subject>
        <type>COUNT_ALL</type>
      </field>
    </fields>
    <give_back_row>Y</give_back_row>
    <directory>%%java.io.tmpdir%%</directory>
    <group>
      <field>
        <name>sap_invoice_number</name>
      </field>
    </group>
    <all_rows>Y</all_rows>
    <prefix>grp</prefix>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>864</yloc>
    </GUI>
  </transform>
  <transform>
    <name>If measure value is null replace by 0</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>ars_rechnungszuteilung</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>ars_rechnungsfreigabe</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>ars_rechnungsprüfung</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_approvals</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_returned_invoice</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_returned_invoice_multiple_times</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>lead_time_ma6</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>lead_time_wrwks</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>gross_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>vat_percent</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>order_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>approved_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_amount_net</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_amount_gross</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_maintenance_deduction</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_adjustment_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_contract_deduction</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_delay_deduction</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_completion_deduction</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>poenale</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_invoices</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_reviewed_invoices</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_approved_invoices</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_deadline_default</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_deadline_red</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_deadline_blue</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_deadline_white</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_deadline_yellow</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_deadline_orange</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_plausible</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_correction</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_questions</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_open</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_in_progress</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>count_in_process</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>sap_completion_deduction_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>sap_correction_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>sap_delay_deduction_amount</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>2288</yloc>
    </GUI>
  </transform>
  <transform>
    <name>If sid value is null</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue>0</replaceAllByValue>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>approver_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>company_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>craft_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>deadline_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>requirement_holder_group_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>requirement_holder_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>reviser_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>sap_invoice_number_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>state_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>first_reviser_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>approved_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>due_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>entry_ma06_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>erp_import_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>first_approved_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>invoice_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>last_approved_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>last_invoice_document_requested_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>last_reopened_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>reviewed_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>state_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>first_reviewed_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>order_date_sid</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>first_approver_sid</name>
        <value>-1</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Modified JavaScript value</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here


var count_correction = 0;
var correction_sid = 0;
var count_plausible = 0;
var plausible_sid = 0;
var count_questions = 0;
var question_sid = 0;


//count_correction
if (
    poenale > 0
    || invoice_adjustment_amount > 0
    || invoice_maintenance_deduction > 0
) {
    count_correction = 1;
	correction_sid = 1;
}

//count_plausible
if (
    poenale == 0

    &amp;&amp; tenant_contacted_sid == 0
    &amp;&amp; company_contacted_sid == 0
    &amp;&amp; on_site_visit_needed_sid == 0
    &amp;&amp; invoice_adjustment_amount == 0
    &amp;&amp; invoice_maintenance_deduction == 0
    &amp;&amp; internal_person_contacted_sid == 0
    &amp;&amp; requirement_holder_contacted_sid == 0
    &amp;&amp; invoicing_documents_requested_sid == 0
	&amp;&amp; clarification_needed_sid == 0
) {
    count_plausible = 1;
	plausible_sid = 1;
}

//count_questions
if (
    tenant_contacted_sid == 1
    || company_contacted_sid == 1
    || on_site_visit_needed_sid == 1
    || internal_person_contacted_sid == 1
    || requirement_holder_contacted_sid == 1
    || invoicing_documents_requested_sid == 1
	|| clarification_needed_sid == 1

) {
    if (
        poenale == 0
        &amp;&amp; invoice_adjustment_amount == 0
        &amp;&amp; invoice_maintenance_deduction == 0
    ) {
        count_questions = 1;
		question_sid = 1;
    }
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>count_correction</name>
        <rename>count_correction</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>correction_sid</name>
        <rename>correction_sid</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>count_plausible</name>
        <rename>count_plausible</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>plausible_sid</name>
        <rename>plausible_sid</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>count_questions</name>
        <rename>count_questions</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>question_sid</name>
        <rename>question_sid</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>320</xloc>
      <yloc>1504</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sort rows</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>4</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory>30</free_memory>
    <compress>Y</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>sap_invoice_number</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>624</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sorted merge</name>
    <type>SortedMerge</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>sap_invoice_number</name>
        <ascending>Y</ascending>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>704</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Switch / case</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cases>
      <case>
        <target_transform>count red</target_transform>
        <value>red</value>
      </case>
      <case>
        <target_transform>count blue</target_transform>
        <value>blue</value>
      </case>
      <case>
        <target_transform>count white</target_transform>
        <value>white</value>
      </case>
      <case>
        <target_transform>count yellow</target_transform>
        <value>yellow</value>
      </case>
      <case>
        <target_transform>count orange</target_transform>
        <value>orange</value>
      </case>
      <case>
        <target_transform>count green</target_transform>
        <value>green</value>
      </case>
    </cases>
    <case_value_type>String</case_value_type>
    <default_target_transform>count 0</default_target_transform>
    <fieldname>deadline_color</fieldname>
    <use_contains>Y</use_contains>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1216</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Switch / case 2</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cases>
      <case>
        <target_transform>count zur Prüfung offen</target_transform>
        <value>new</value>
      </case>
      <case>
        <target_transform>count zur Prüfung offen</target_transform>
        <value>assigned</value>
      </case>
      <case>
        <target_transform>count zur Prüfung offen</target_transform>
        <value>in_progress</value>
      </case>
      <case>
        <target_transform>count zur Prüfung offen</target_transform>
        <value>missing_data</value>
      </case>
      <case>
        <target_transform>count zur Prüfung offen</target_transform>
        <value>reopened</value>
      </case>
      <case>
        <target_transform>count in Arbeit</target_transform>
        <value>in_approval</value>
      </case>
      <case>
        <target_transform>count in Arbeit</target_transform>
        <value>pending_approval</value>
      </case>
    </cases>
    <case_value_type>String</case_value_type>
    <default_target_transform>count 0 2</default_target_transform>
    <fieldname>deadline_color</fieldname>
    <use_contains>Y</use_contains>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1664</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Table output fact_invoice_clearances</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <commit>1000</commit>
    <connection>L4</connection>
    <fields>
      <field>
        <column_name>id</column_name>
        <stream_name>id</stream_name>
      </field>
      <field>
        <column_name>sap_invoice_number</column_name>
        <stream_name>sap_invoice_number</stream_name>
      </field>
      <field>
        <column_name>ars_rechnungszuteilung</column_name>
        <stream_name>ars_rechnungszuteilung</stream_name>
      </field>
      <field>
        <column_name>ars_rechnungsfreigabe</column_name>
        <stream_name>ars_rechnungsfreigabe</stream_name>
      </field>
      <field>
        <column_name>ars_rechnungsprüfung</column_name>
        <stream_name>ars_rechnungsprüfung</stream_name>
      </field>
      <field>
        <column_name>count_approvals</column_name>
        <stream_name>count_approvals</stream_name>
      </field>
      <field>
        <column_name>count_returned_invoice</column_name>
        <stream_name>count_returned_invoice</stream_name>
      </field>
      <field>
        <column_name>count_returned_invoice_multiple_times</column_name>
        <stream_name>count_returned_invoice_multiple_times</stream_name>
      </field>
      <field>
        <column_name>lead_time_ma6</column_name>
        <stream_name>lead_time_ma6</stream_name>
      </field>
      <field>
        <column_name>lead_time_wrwks</column_name>
        <stream_name>lead_time_wrwks</stream_name>
      </field>
      <field>
        <column_name>amount</column_name>
        <stream_name>amount</stream_name>
      </field>
      <field>
        <column_name>order_amount</column_name>
        <stream_name>order_amount</stream_name>
      </field>
      <field>
        <column_name>approved_amount</column_name>
        <stream_name>approved_amount</stream_name>
      </field>
      <field>
        <column_name>invoice_maintenance_deduction</column_name>
        <stream_name>invoice_maintenance_deduction</stream_name>
      </field>
      <field>
        <column_name>invoice_adjustment_amount</column_name>
        <stream_name>invoice_adjustment_amount</stream_name>
      </field>
      <field>
        <column_name>invoice_delay_deduction</column_name>
        <stream_name>invoice_delay_deduction</stream_name>
      </field>
      <field>
        <column_name>invoice_completion_deduction</column_name>
        <stream_name>invoice_completion_deduction</stream_name>
      </field>
      <field>
        <column_name>poenale</column_name>
        <stream_name>poenale</stream_name>
      </field>
      <field>
        <column_name>invoice_to_requirement_holder_sid</column_name>
        <stream_name>invoice_to_requirement_holder_sid</stream_name>
      </field>
      <field>
        <column_name>back_from_accounting_sid</column_name>
        <stream_name>back_from_accounting_sid</stream_name>
      </field>
      <field>
        <column_name>requirement_holder_contacted_sid</column_name>
        <stream_name>requirement_holder_contacted_sid</stream_name>
      </field>
      <field>
        <column_name>tenant_contacted_sid</column_name>
        <stream_name>tenant_contacted_sid</stream_name>
      </field>
      <field>
        <column_name>company_contacted_sid</column_name>
        <stream_name>company_contacted_sid</stream_name>
      </field>
      <field>
        <column_name>invoicing_documents_requested_sid</column_name>
        <stream_name>invoicing_documents_requested_sid</stream_name>
      </field>
      <field>
        <column_name>on_site_visit_needed_sid</column_name>
        <stream_name>on_site_visit_needed_sid</stream_name>
      </field>
      <field>
        <column_name>maintenance_deduction_manually_changed_sid</column_name>
        <stream_name>maintenance_deduction_manually_changed_sid</stream_name>
      </field>
      <field>
        <column_name>internal_person_contacted_sid</column_name>
        <stream_name>internal_person_contacted_sid</stream_name>
      </field>
      <field>
        <column_name>clarification_needed_sid</column_name>
        <stream_name>clarification_needed_sid</stream_name>
      </field>
      <field>
        <column_name>invoice_delay_deduction_sid</column_name>
        <stream_name>invoice_delay_deduction_sid</stream_name>
      </field>
      <field>
        <column_name>invoice_completion_deduction_sid</column_name>
        <stream_name>invoice_completion_deduction_sid</stream_name>
      </field>
      <field>
        <column_name>poenale_sid</column_name>
        <stream_name>poenale_sid</stream_name>
      </field>
      <field>
        <column_name>approver_sid</column_name>
        <stream_name>approver_sid</stream_name>
      </field>
      <field>
        <column_name>company_sid</column_name>
        <stream_name>company_sid</stream_name>
      </field>
      <field>
        <column_name>craft_sid</column_name>
        <stream_name>craft_sid</stream_name>
      </field>
      <field>
        <column_name>deadline_sid</column_name>
        <stream_name>deadline_sid</stream_name>
      </field>
      <field>
        <column_name>requirement_holder_group_sid</column_name>
        <stream_name>requirement_holder_group_sid</stream_name>
      </field>
      <field>
        <column_name>requirement_holder_sid</column_name>
        <stream_name>requirement_holder_sid</stream_name>
      </field>
      <field>
        <column_name>reviser_sid</column_name>
        <stream_name>reviser_sid</stream_name>
      </field>
      <field>
        <column_name>sap_invoice_number_sid</column_name>
        <stream_name>sap_invoice_number_sid</stream_name>
      </field>
      <field>
        <column_name>state_sid</column_name>
        <stream_name>state_sid</stream_name>
      </field>
      <field>
        <column_name>approved_date_sid</column_name>
        <stream_name>approved_date_sid</stream_name>
      </field>
      <field>
        <column_name>due_date_sid</column_name>
        <stream_name>due_date_sid</stream_name>
      </field>
      <field>
        <column_name>entry_ma06_date_sid</column_name>
        <stream_name>entry_ma06_date_sid</stream_name>
      </field>
      <field>
        <column_name>erp_import_date_sid</column_name>
        <stream_name>erp_import_date_sid</stream_name>
      </field>
      <field>
        <column_name>first_approved_date_sid</column_name>
        <stream_name>first_approved_date_sid</stream_name>
      </field>
      <field>
        <column_name>invoice_date_sid</column_name>
        <stream_name>invoice_date_sid</stream_name>
      </field>
      <field>
        <column_name>last_approved_date_sid</column_name>
        <stream_name>last_approved_date_sid</stream_name>
      </field>
      <field>
        <column_name>last_invoice_document_requested_date_sid</column_name>
        <stream_name>last_invoice_document_requested_date_sid</stream_name>
      </field>
      <field>
        <column_name>last_reopened_date_sid</column_name>
        <stream_name>last_reopened_date_sid</stream_name>
      </field>
      <field>
        <column_name>reviewed_date_sid</column_name>
        <stream_name>reviewed_date_sid</stream_name>
      </field>
      <field>
        <column_name>state_date_sid</column_name>
        <stream_name>state_date_sid</stream_name>
      </field>
      <field>
        <column_name>count_invoices</column_name>
        <stream_name>count_invoices</stream_name>
      </field>
      <field>
        <column_name>count_reviewed_invoices</column_name>
        <stream_name>count_reviewed_invoices</stream_name>
      </field>
      <field>
        <column_name>count_approved_invoices</column_name>
        <stream_name>count_approved_invoices</stream_name>
      </field>
      <field>
        <column_name>count_deadline_default</column_name>
        <stream_name>count_deadline_default</stream_name>
      </field>
      <field>
        <column_name>count_deadline_red</column_name>
        <stream_name>count_deadline_red</stream_name>
      </field>
      <field>
        <column_name>count_deadline_blue</column_name>
        <stream_name>count_deadline_blue</stream_name>
      </field>
      <field>
        <column_name>count_deadline_white</column_name>
        <stream_name>count_deadline_white</stream_name>
      </field>
      <field>
        <column_name>count_deadline_yellow</column_name>
        <stream_name>count_deadline_yellow</stream_name>
      </field>
      <field>
        <column_name>count_deadline_orange</column_name>
        <stream_name>count_deadline_orange</stream_name>
      </field>
      <field>
        <column_name>count_deadline_green</column_name>
        <stream_name>count_deadline_green</stream_name>
      </field>
      <field>
        <column_name>count_plausible</column_name>
        <stream_name>count_plausible</stream_name>
      </field>
      <field>
        <column_name>count_correction</column_name>
        <stream_name>count_correction</stream_name>
      </field>
      <field>
        <column_name>count_questions</column_name>
        <stream_name>count_questions</stream_name>
      </field>
      <field>
        <column_name>count_open</column_name>
        <stream_name>count_open</stream_name>
      </field>
      <field>
        <column_name>count_in_progress</column_name>
        <stream_name>count_in_progress</stream_name>
      </field>
      <field>
        <column_name>count_in_process</column_name>
        <stream_name>count_in_process</stream_name>
      </field>
      <field>
        <column_name>dwh_batch_id</column_name>
        <stream_name>dwh_batch_id</stream_name>
      </field>
      <field>
        <column_name>plausible_sid</column_name>
        <stream_name>plausible_sid</stream_name>
      </field>
      <field>
        <column_name>correction_sid</column_name>
        <stream_name>correction_sid</stream_name>
      </field>
      <field>
        <column_name>question_sid</column_name>
        <stream_name>question_sid</stream_name>
      </field>
      <field>
        <column_name>dim_amount</column_name>
        <stream_name>dim_amount</stream_name>
      </field>
      <field>
        <column_name>dim_approved_amount</column_name>
        <stream_name>dim_approved_amount</stream_name>
      </field>
      <field>
        <column_name>dim_invoice_adjustment_amount</column_name>
        <stream_name>dim_invoice_adjustment_amount</stream_name>
      </field>
      <field>
        <column_name>dim_invoice_maintenance_deduction</column_name>
        <stream_name>dim_invoice_maintenance_deduction</stream_name>
      </field>
      <field>
        <column_name>dim_order_amount</column_name>
        <stream_name>dim_order_amount</stream_name>
      </field>
      <field>
        <column_name>dim_invoice_deduction_category_amount</column_name>
        <stream_name>dim_invoice_deduction_category_amount</stream_name>
      </field>
      <field>
        <column_name>error_value</column_name>
        <stream_name>error_value</stream_name>
      </field>
      <field>
        <column_name>dim_error_value</column_name>
        <stream_name>dim_error_value</stream_name>
      </field>
      <field>
        <column_name>first_return_date_sid</column_name>
        <stream_name>first_return_date_sid</stream_name>
      </field>
      <field>
        <column_name>first_reviewed_date_sid</column_name>
        <stream_name>first_reviewed_date_sid</stream_name>
      </field>
      <field>
        <column_name>first_reviser_sid</column_name>
        <stream_name>first_reviser_sid</stream_name>
      </field>
      <field>
        <column_name>sap_completion_deduction_amount</column_name>
        <stream_name>sap_completion_deduction_amount</stream_name>
      </field>
      <field>
        <column_name>sap_correction_amount</column_name>
        <stream_name>sap_correction_amount</stream_name>
      </field>
      <field>
        <column_name>sap_delay_deduction_amount</column_name>
        <stream_name>sap_delay_deduction_amount</stream_name>
      </field>
      <field>
        <column_name>first_approver_sid</column_name>
        <stream_name>first_approver_sid</stream_name>
      </field>
      <field>
        <column_name>order_date_sid</column_name>
        <stream_name>order_date_sid</stream_name>
      </field>
      <field>
        <column_name>tenant_charge</column_name>
        <stream_name>tenant_charge</stream_name>
      </field>
      <field>
        <column_name>reviser_historic_team_sid</column_name>
        <stream_name>reviser_historic_team_sid</stream_name>
      </field>
      <field>
        <column_name>approver_historic_team_sid</column_name>
        <stream_name>approver_historic_team_sid</stream_name>
      </field>
    </fields>
    <ignore_errors>N</ignore_errors>
    <only_when_have_rows>N</only_when_have_rows>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_monthly>Y</partitioning_monthly>
    <return_keys>N</return_keys>
    <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
    <specify_fields>Y</specify_fields>
    <table>fact_invoice_clearances</table>
    <tablename_in_field>N</tablename_in_field>
    <tablename_in_table>Y</tablename_in_table>
    <truncate>N</truncate>
    <use_batch>Y</use_batch>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>2368</yloc>
    </GUI>
  </transform>
  <transform>
    <name>approved_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>3</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>approved_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>approved_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>approved_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>approved_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>144</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>approved_date_sid &lt;&gt; 0</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>count_approved_invoices 1</send_true_to>
    <send_false_to>count_approved_invoices 0</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>approved_date_sid</leftvalue>
            <function>LIKE</function>
            <rightvalue/>
          </condition>
          <condition>
            <negated>N</negated>
            <operator>OR</operator>
            <leftvalue>approved_date_sid</leftvalue>
            <function>&lt;></function>
            <rightvalue/>
            <value>
              <name>constant</name>
              <type>Integer</type>
              <text>0</text>
              <length>-1</length>
              <precision>0</precision>
              <isnull>N</isnull>
              <mask>####0;-####0</mask>
            </value>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1136</yloc>
    </GUI>
  </transform>
  <transform>
    <name>approver_historic_team</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>approver_historic_team_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <default>1</default>
        <rename>approver_historic_team_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_teams</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>912</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>approver_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>approver_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>approver_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_users_erp</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>144</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>companies_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>company_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>company_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_companies</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>256</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count 0</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>784</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count 0 2</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_open</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_in_progress</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_in_process</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>784</xloc>
      <yloc>1776</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count blue</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count green</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>64</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count in Arbeit</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_open</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_in_progress</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_in_process</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1776</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count orange</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>160</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count red</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>320</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count white</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>544</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count yellow</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_default</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_red</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_blue</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_white</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_yellow</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_orange</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_deadline_green</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>240</xloc>
      <yloc>1360</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count zur Prüfung offen</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_open</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_in_progress</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_in_process</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>304</xloc>
      <yloc>1776</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count_approved_invoices 0</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_approved_invoices</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>256</xloc>
      <yloc>1136</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count_approved_invoices 1</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_approved_invoices</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>608</xloc>
      <yloc>1136</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count_invoices</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_invoices</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>976</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count_reviewed_invoices 0</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_reviewed_invoices</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>0</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>256</xloc>
      <yloc>1056</yloc>
    </GUI>
  </transform>
  <transform>
    <name>count_reviewed_invoices 1</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <set_empty_string>N</set_empty_string>
        <length>-1</length>
        <name>count_reviewed_invoices</name>
        <precision>-1</precision>
        <type>Integer</type>
        <nullif>1</nullif>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>608</xloc>
      <yloc>1056</yloc>
    </GUI>
  </transform>
  <transform>
    <name>craft_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>craft_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>craft_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_crafts</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>352</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>deadline_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>deadline</name>
        <field>deadline</field>
      </key>
      <key>
        <condition>=</condition>
        <name>deadline_color</name>
        <field>deadline_color</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>deadline_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_invoice_deadlines</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>448</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>dim_requirement_holder_groups_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>requirement_holder_group_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>requirement_holder_group_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_requirement_holder_groups</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>624</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>due_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>due_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>due_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>due_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>due_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>272</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>dynamic Dimension on Measure-Values</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formulas>
</formulas>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>2128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>entry_ma06_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>entry_ma06_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>entry_ma06_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>entry_ma06_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>entry_ma06_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>416</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>erp_import_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>3</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>erp_import_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>erp_import_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>erp_import_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>erp_import_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>576</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>first_approved_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>3</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>first_approved_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>first_approved_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>first_approved_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>first_approved_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>720</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>first_approver_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>first_approver__user_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>first_approver_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_users_erp</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>768</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>first_return_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>4</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>first_return_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>first_return_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>first_return_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>first_return_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>880</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>first_reviewed_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>4</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>first_reviewed_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>first_reviewed_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>first_reviewed_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>first_reviewed_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1040</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>invoice_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>invoice_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>invoice_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>invoice_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>invoice_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1248</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>l3_baus.invoice_clearances</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>L3</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>with first_approved_date as (select min(s.created_at) as first_approved_date, ic.id
                             from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                      left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                      left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                             where ic.dwh_current = true
                               and ic.dwh_deleted = false
                               and st.shortname = 'invoice_clearance.approved'
                             group by ic.id),
     last_approved_date as (select max(s.created_at) as last_approved_date, ic.id
                            from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                     left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                     left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                            where ic.dwh_current = true
                              and ic.dwh_deleted = false
                              and st.shortname = 'invoice_clearance.approved'
                            group by ic.id),
     last_invoice_document_requested_dateas as (select max(s.created_at) as last_invoice_document_requested_date, ic.id
                                                from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                                         left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                                         left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                                                where ic.dwh_current = true
                                                  and ic.dwh_deleted = false
                                                  and st.shortname = 'invoice_clearance.invoicing_documents_requested'
                                                group by ic.id),
     last_state_date as (select max(s.created_at) as last_state_date, ic.id
                         from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                  left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                  left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                         where ic.dwh_current = true
                           and ic.dwh_deleted = false
                         group by ic.id),
     first_return as (select sap_invoice_number, created_at as first_return_date, first_return_reason, first_return_text
                      from (select ic.sap_invoice_number
                                 , s.created_at
                                 , split_part(s.notes, E'\n', 1)   as                                           first_return_reason
                                 , split_part(s.notes, E'\n\n', 2) as                                           first_return_text
                                 , row_number() over (partition by ic.sap_invoice_number order by s.created_at) rownum
                            from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                     left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                     left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                            where ic.dwh_current = true
                              and ic.dwh_deleted = false
                              and s.stateable_type = 'InvoiceClearance'
                              and st.shortname = 'invoice_clearance.rejected') as zt
                      where zt.rownum = 1),
     count_approvals as (select count(*) as count_approvals, ic.id
                         from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                  left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                  left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                         where ic.dwh_current = true
                           and ic.dwh_deleted = false
                           and st.shortname = 'invoice_clearance.approved'
                         group by ic.id),
     invoice_to_requirement_holder as (select 1 as invoice_to_requirement_holder_sid, ic.id
                                       from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                                left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                                left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                                       where ic.dwh_current = true
                                         and ic.dwh_deleted = false
                                         and st.shortname = 'invoice_clearance.sent_to_requirement_holder'
                                       group by ic.id),
     back_from_accounting as (select 1 as back_from_accounting_sid, ic.id, max(s.created_at) as last_reopened_date
                              from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
                                       left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                                       left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
                              where ic.dwh_current = true
                                and ic.dwh_deleted = false
                                and st.shortname = 'invoice_clearance.reopened'
                              group by ic.id),
     returned_invoices as (select ic.id, 1 as count_returned_invoice, sum(1) as count_returned_invoice_multiple_times
                           from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances        ic
                                    inner join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.stateable_type = 'InvoiceClearance' and s.dwh_current = true and s.dwh_deleted = false
                                    inner join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.shortname = 'invoice_clearance.rejected' and s.dwh_current = true and st.dwh_deleted = false
                           where ic.dwh_current = true
                             and ic.dwh_deleted = false
                           group by ic.id),
     dim_invoice_deduction_category_amount as (select distinct ic.id as ic_id, 1 as boo
                                               from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances                                         ic
                                                        left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearance_invoice_deduction_category icidc on ic.id = icidc.invoice_clearance_id and icidc.dwh_current = true and icidc.dwh_deleted = false
                                               where ic.dwh_current = true
                                                 and ic.dwh_deleted = false
                                                 and icidc.amount is not null)
, _first_approver_base as ( -- dwh-1870: erste/r Freigeber/in
    select
      s.user_id as first_approver__user_id
      , ic.id as ic_id
      , row_number() over (partition by ic.id order by ic.id asc, s.created_at asc ) as rn
    from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
    left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
    left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
    where 1=1
      and st.shortname = 'invoice_clearance.approved'
    order by s.created_at asc
), _first_approver as (
  select distinct
    first_approver__user_id
    ,ic_id
  from _first_approver_base
  where rn=1
),
_review_date as (
select ic.id, max(s.created_at) as reviewed_date
                             from ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances       ic
							 left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.states     s on ic.id = s.stateable_id and s.dwh_current = true and s.dwh_deleted = false
                             left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.statetypes st on s.statetype_id = st.id and st.dwh_current = true and st.dwh_deleted = false
							where ic.dwh_current = true
                            and ic.dwh_deleted = false
                            and s.stateable_type = 'InvoiceClearance'
               				and st.shortname = 'invoice_clearance.pre_approval_comment'
							group by ic.id
                            order by ic.id, max(s.created_at) desc
)




SELECT ic.id                                                                                                                         as id
     , ic.craft_id                                                                                                                   as craft_id
     , ic.company_id                                                                                                                 as company_id
     , ic.approver_id                                                                                                                as approver_id
     , ic.reviser_id                                                                                                                 as reviser_id
     , ic.requirement_holder_id                                                                                                      as requirement_holder_id
     , ic.sap_invoice_number                                                                                                         as sap_invoice_number
     ,ic.requirement_holder_group_id                                                                                                 as requirement_holder_group_id
     , ic.purchasing_group                                                                                                           as purchasing_group
     , case when ic."state" = 'in_progress' and ic.locked_by_id is not null then 'Bearbeitung durch Prüfer'
            when ic.state = 'done' and bra.back_from_accounting_sid = 1 then 'Abgeschlossen nach Wiedereröffnung'
            when ic.state = 'done' and itrh.invoice_to_requirement_holder_sid = 1 then 'Weitergeleitet an den Besteller'
            else ic."state" end                                                                                                      as state
     , ic.deadline                                                                                                                   as deadline
     , ic.deadline_color                                                                                                             as deadline_color
     , concat(u.last_name, ' ', u.first_name)                                                                                        as user_full_name
     , btr.ma                                                                                                                        as ma
     , btr.ars_rechnungszuteilung                                                                                                    as ars_rechnungszuteilung
     , btr.ars_rechnungsfreigabe                                                                                                     as ars_rechnungsfreigabe
     , btr.ars_rechnungsprüfung                                                                                                      as ars_rechnungsprüfung

     --measures
     , ca.count_approvals                                                                                                            as count_approvals
     , coalesce(ri.count_returned_invoice, 0)                                                                                        as count_returned_invoice
     , coalesce(ri.count_returned_invoice_multiple_times, 0)                                                                         as count_returned_invoice_multiple_times

     , EXTRACT(EPOCH FROM (ic.approved_date - ic.entry_ma06_date))                                                                   as lead_time_ma6
     , EXTRACT(EPOCH FROM (ic.approved_date - ic.erp_import_date))                                                                   as lead_time_wrwks

     , COALESCE(ic.amount::float / 100, 0)                                                                                           as amount
     , COALESCE(ic.gross_amount::float / 100, 0)                                                                                     as gross_amount
     , COALESCE(ic.vat_percent::float / 100, 0)                                                                                      as vat_percent
     , COALESCE(ic.order_amount::float / 100, 0)                                                                                     as order_amount
     , COALESCE(ic.approved_amount::float / 100, 0)                                                                                  as approved_amount
     , COALESCE(ic.invoice_amount_net::float / 100, 0)                                                                               as invoice_amount_net
     , COALESCE(ic.invoice_amount_gross::float / 100, 0)                                                                             as invoice_amount_gross
     , COALESCE(ic.invoice_maintenance_deduction::float / 100, 0)                                                                    as invoice_maintenance_deduction
     , COALESCE(ic.invoice_adjustment_amount::float / 100, 0)                                                                        as invoice_adjustment_amount
     , COALESCE(ic.invoice_contract_deduction::float / 100, 0)                                                                       as invoice_contract_deduction
     , COALESCE(ic.invoice_delay_deduction::float / 100, 0)                                                                          as invoice_delay_deduction
     , COALESCE(ic.invoice_completion_deduction::float / 100, 0)                                                                     as invoice_completion_deduction
     , COALESCE(ic.invoice_delay_deduction::float / 100, 0) + COALESCE(ic.invoice_completion_deduction::float / 100, 0)              as poenale
   , COALESCE(ic.sap_correction_amount::float / 100,0) + COALESCE(ic.sap_completion_deduction_amount::float / 100,0) + COALESCE(ic.sap_delay_deduction_amount::float / 100,0) as error_value
   , COALESCE(ic.sap_completion_deduction_amount::float / 100, 0)                                                                    as sap_completion_deduction_amount
   , COALESCE(ic.sap_correction_amount::float / 100, 0)                                                                              as sap_correction_amount
   , COALESCE(ic.sap_delay_deduction_amount::float / 100, 0)                                                                         as sap_delay_deduction_amount

     --dim_boolean
     , coalesce(itrh.invoice_to_requirement_holder_sid, 0)                                                                           as invoice_to_requirement_holder_sid
     , coalesce(bra.back_from_accounting_sid, 0)                                                                                     as back_from_accounting_sid
     , case when ic.tenant_contacted = true then 1 else 0 end                                                                        as tenant_contacted_sid
     , case when ic.requirement_holder_contacted = true then 1 else 0 end                                                            as requirement_holder_contacted_sid
     , case when ic.company_contacted = true then 1 else 0 end                                                                       as company_contacted_sid
     , case when ic.invoicing_documents_requested = true then 1 else 0 end                                                           as invoicing_documents_requested_sid
     , case when ic.on_site_visit_needed = true then 1 else 0 end                                                                    as on_site_visit_needed_sid
     , case when ic.maintenance_deduction_manually_changed = true then 1 else 0 end                                                  as maintenance_deduction_manually_changed_sid
     , case when ic.internal_person_contacted = true then 1 else 0 end                                                               as internal_person_contacted_sid
     , case when ic.clarification_needed = true then 1 else 0 end                                                                    as clarification_needed_sid
     , case when COALESCE(ic.invoice_delay_deduction, 0) != 0 then 1 else 0 end                                                      as invoice_delay_deduction_sid
     , case when COALESCE(ic.invoice_completion_deduction, 0) != 0 then 1 else 0 end                                                 as invoice_completion_deduction_sid
     , case when COALESCE(ic.invoice_delay_deduction, 0) != 0 or COALESCE(ic.invoice_completion_deduction, 0) != 0 then 1 else 0 end as poenale_sid
     , coalesce(didca.boo, 0)                                                                                                        as dim_invoice_deduction_category_amount
	 , cast (case when ic.tenant_charge::text is null then '-1'::text 
			when ic.tenant_charge::text = 'false' then '0'
			when ic.tenant_charge::text = 'true' then '1'
			else ic.tenant_charge::text end as int)																					 as tenant_charge

     --dim_time
     , date_trunc('day', invoice_date)                                                                                               as invoice_date_day
     , EXTRACT(HOUR FROM invoice_date)::integer                                                                                      as invoice_date_hour
     , floor(EXTRACT(MINUTE FROM invoice_date) / 15)::integer                                                                        as invoice_date_15min

     , date_trunc('day', due_date)                                                                                                   as due_date_day
     , EXTRACT(HOUR FROM due_date)::integer                                                                                          as due_date_hour
     , floor(EXTRACT(MINUTE FROM due_date) / 15)::integer                                                                            as due_date_15min

     , date_trunc('day', rd.reviewed_date)                                                                                              as reviewed_date_day
     , EXTRACT(HOUR FROM rd.reviewed_date)::integer                                                                                     as reviewed_date_hour
     , floor(EXTRACT(MINUTE FROM rd.reviewed_date) / 15)::integer                                                                       as reviewed_date_15min

     , date_trunc('day', approved_date)                                                                                              as approved_date_day
     , EXTRACT(HOUR FROM approved_date)::integer                                                                                     as approved_date_hour
     , floor(EXTRACT(MINUTE FROM approved_date) / 15)::integer                                                                       as approved_date_15min

     , date_trunc('day', ic.entry_ma06_date)                                                                                         as entry_ma06_date_day
     , EXTRACT(HOUR FROM ic.entry_ma06_date)::integer                                                                                as entry_ma06_date_hour
     , floor(EXTRACT(MINUTE FROM ic.entry_ma06_date) / 15)::integer                                                                  as entry_ma06_date_15min

     , date_trunc('day', ic.erp_import_date)                                                                                         as erp_import_date_day
     , EXTRACT(HOUR FROM ic.erp_import_date)::integer                                                                                as erp_import_date_hour
     , floor(EXTRACT(MINUTE FROM ic.erp_import_date) / 15)::integer                                                                  as erp_import_date_15min

     , date_trunc('day', lsd.last_state_date)                                                                                        as state_date_day
     , EXTRACT(HOUR FROM lsd.last_state_date)::integer                                                                               as state_date_hour
     , floor(EXTRACT(MINUTE FROM lsd.last_state_date) / 15)::integer                                                                 as state_date_15min

     , date_trunc('day', fad.first_approved_date)                                                                                    as first_approved_date_day
     , EXTRACT(HOUR FROM fad.first_approved_date)::integer                                                                           as first_approved_date_hour
     , floor(EXTRACT(MINUTE FROM fad.first_approved_date) / 15)::integer                                                             as first_approved_date_15min

     , date_trunc('day', lad.last_approved_date)                                                                                     as last_approved_date_day
     , EXTRACT(HOUR FROM lad.last_approved_date)::integer                                                                            as last_approved_date_hour
     , floor(EXTRACT(MINUTE FROM lad.last_approved_date) / 15)::integer                                                              as last_approved_date_15min

     , date_trunc('day', lidrd.last_invoice_document_requested_date)                                                                 as last_invoice_document_requested_date_day
     , EXTRACT(HOUR FROM lidrd.last_invoice_document_requested_date)::integer                                                        as last_invoice_document_requested_date_hour
     , floor(EXTRACT(MINUTE FROM lidrd.last_invoice_document_requested_date) / 15)::integer                                          as last_invoice_document_requested_date_15min

     , date_trunc('day', bra.last_reopened_date)                                                                                     as last_reopened_date_day
     , EXTRACT(HOUR FROM bra.last_reopened_date)::integer                                                                            as last_reopened_date_hour
     , floor(EXTRACT(MINUTE FROM bra.last_reopened_date) / 15)::integer                                                              as last_reopened_date_15min

     , date_trunc('day', fr.first_return_date)                                                                                     as first_return_date_day
     , EXTRACT(HOUR FROM fr.first_return_date)::integer                                                                            as first_return_date_hour
     , floor(EXTRACT(MINUTE FROM fr.first_return_date) / 15)::integer                                                              as first_return_date_15min

	 , date_trunc('day', dfr.first_reviewed_date)                                                                                    as first_reviewed_date_day
     , EXTRACT(HOUR FROM dfr.first_reviewed_date)::integer                                                                           as first_reviewed_date_hour
     , floor(EXTRACT(MINUTE FROM dfr.first_reviewed_date) / 15)::integer                                                             as first_reviewed_date_15min

     , date_trunc('day', so.order_date)                                                                                    as order_date_day
     , EXTRACT(HOUR FROM so.order_date)::integer                                                                           as order_date_hour
     , floor(EXTRACT(MINUTE FROM so.order_date) / 15)::integer                                                             as order_date_15min

     , COALESCE(dfr.dwh_sid, -1)                                                                                                   as first_reviser_sid
     , l4fact.id                                                                                                                   as l4fact_id
     , COALESCE(fa.first_approver__user_id, -1)                                                                                  as first_approver__user_id  -- erste/r Freigeber/in
 	 , tu.team_id 																													 as reviser_historic_team_id
	 , tu2.team_id 																													 as approver_historic_team_id
FROM ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.invoice_clearances                      ic
         left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.users                     u on ic.approver_id = u.id and u.dwh_current = true and u.dwh_deleted = false
         left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.sap_orders so on ic.order_number::text = so.id::text and so.dwh_current = true and so.dwh_deleted = false
         left join ${L3_SCHEMA}_${BAUS_ERP_SCHEMA}.time_recording                             btr on btr.ma = concat(u.last_name, ' ', u.first_name) and btr.dwh_current = true and btr.dwh_deleted = false
         LEFT JOIN first_approved_date                                    fad on ic.id = fad.id
         LEFT JOIN last_approved_date                                     lad on ic.id = lad.id
         LEFT JOIN last_invoice_document_requested_dateas                 lidrd on ic.id = lidrd.id
         LEFT JOIN last_state_date                                        lsd on ic.id = lsd.id
		 LEFT JOIN _review_date											  rd on ic.id= rd.id
         LEFT JOIN first_return                                           fr on fr.sap_invoice_number = ic.sap_invoice_number
         LEFT JOIN count_approvals                                        ca on ic.id = ca.id
         LEFT JOIN invoice_to_requirement_holder                          itrh on ic.id = itrh.id
         LEFT JOIN back_from_accounting                                   bra on ic.id = bra.id
         LEFT JOIN returned_invoices                                      ri on ic.id = ri.id
         left join dim_invoice_deduction_category_amount                  didca on ic.id = didca.ic_id
         LEFT JOIN _first_approver                                        fa on ic.id = fa.ic_id
         LEFT JOIN ${L4_SCHEMA}_${BAUS_ERP_SCHEMA}.fact_invoice_clearances                    l4fact on ic.id = l4fact.id
		 LEFT JOIN ${L4_SCHEMA}_${BAUS_ERP_SCHEMA}.dim_first_review                              dfr on ic.sap_invoice_number = dfr.sap_invoice_number
		 left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.team_user 	  tu on ic.reviser_id = tu.user_id and rd.reviewed_date >= tu.dwh_valid_from and  rd.reviewed_date &lt; tu.dwh_valid_to and tu.dwh_deleted = false
		 left join ${L3_SCHEMA}${BAUS_SCHEMA_EXTENSION_L3}.team_user 	  tu2 on ic.approver_id = tu2.user_id and approved_date >= tu2.dwh_valid_from and approved_date &lt; tu2.dwh_valid_to and tu2.dwh_deleted = false
where ic.dwh_current = true
  and ic.dwh_deleted = false;</sql>
    <variables_active>Y</variables_active>
    <attributes/>
    <GUI>
      <xloc>144</xloc>
      <yloc>208</yloc>
    </GUI>
  </transform>
  <transform>
    <name>last_approved_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>3</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>last_approved_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>last_approved_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>last_approved_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>last_approved_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1424</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>last_invoice_document_requested_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>last_invoice_document_requested_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>last_invoice_document_requested_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>last_invoice_document_requested_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>last_invoice_document_requested_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>128</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>last_reopened_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>last_reopened_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>last_reopened_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>last_reopened_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>last_reopened_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>384</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>order_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>order_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>order_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>order_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>order_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1600</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>remove fields</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>craft_id</name>
      </remove>
      <remove>
        <name>company_id</name>
      </remove>
      <remove>
        <name>approver_id</name>
      </remove>
      <remove>
        <name>reviser_id</name>
      </remove>
      <remove>
        <name>requirement_holder_id</name>
      </remove>
      <remove>
        <name>requirement_holder_group_id</name>
      </remove>
      <remove>
        <name>purchasing_group</name>
      </remove>
      <remove>
        <name>deadline</name>
      </remove>
      <remove>
        <name>user_full_name</name>
      </remove>
      <remove>
        <name>ma</name>
      </remove>
      <remove>
        <name>invoice_date_day</name>
      </remove>
      <remove>
        <name>invoice_date_hour</name>
      </remove>
      <remove>
        <name>invoice_date_15min</name>
      </remove>
      <remove>
        <name>due_date_day</name>
      </remove>
      <remove>
        <name>due_date_hour</name>
      </remove>
      <remove>
        <name>due_date_15min</name>
      </remove>
      <remove>
        <name>reviewed_date_day</name>
      </remove>
      <remove>
        <name>reviewed_date_hour</name>
      </remove>
      <remove>
        <name>reviewed_date_15min</name>
      </remove>
      <remove>
        <name>approved_date_day</name>
      </remove>
      <remove>
        <name>approved_date_hour</name>
      </remove>
      <remove>
        <name>approved_date_15min</name>
      </remove>
      <remove>
        <name>entry_ma06_date_day</name>
      </remove>
      <remove>
        <name>entry_ma06_date_hour</name>
      </remove>
      <remove>
        <name>entry_ma06_date_15min</name>
      </remove>
      <remove>
        <name>erp_import_date_day</name>
      </remove>
      <remove>
        <name>erp_import_date_hour</name>
      </remove>
      <remove>
        <name>erp_import_date_15min</name>
      </remove>
      <remove>
        <name>state_date_day</name>
      </remove>
      <remove>
        <name>state_date_hour</name>
      </remove>
      <remove>
        <name>state_date_15min</name>
      </remove>
      <remove>
        <name>first_approved_date_day</name>
      </remove>
      <remove>
        <name>first_approved_date_hour</name>
      </remove>
      <remove>
        <name>first_approved_date_15min</name>
      </remove>
      <remove>
        <name>last_approved_date_day</name>
      </remove>
      <remove>
        <name>last_approved_date_hour</name>
      </remove>
      <remove>
        <name>last_approved_date_15min</name>
      </remove>
      <remove>
        <name>last_invoice_document_requested_date_day</name>
      </remove>
      <remove>
        <name>last_invoice_document_requested_date_hour</name>
      </remove>
      <remove>
        <name>last_invoice_document_requested_date_15min</name>
      </remove>
      <remove>
        <name>last_reopened_date_day</name>
      </remove>
      <remove>
        <name>last_reopened_date_hour</name>
      </remove>
      <remove>
        <name>last_reopened_date_15min</name>
      </remove>
      <remove>
        <name>l4fact_id</name>
      </remove>
      <remove>
        <name>first_return_date_15min</name>
      </remove>
      <remove>
        <name>first_return_date_day</name>
      </remove>
      <remove>
        <name>first_return_date_hour</name>
      </remove>
      <remove>
        <name>first_reviewed_date_day</name>
      </remove>
      <remove>
        <name>first_reviewed_date_hour</name>
      </remove>
      <remove>
        <name>first_reviewed_date_15min</name>
      </remove>
      <remove>
        <name>first_approver__user_id</name>
      </remove>
      <remove>
        <name>order_date_15min</name>
      </remove>
      <remove>
        <name>order_date_day</name>
      </remove>
      <remove>
        <name>order_date_hour</name>
      </remove>
    </fields>
    <attributes/>
    <GUI>
      <xloc>640</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>requirement_holder_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>requirement_holder_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>requirement_holder_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_users_erp</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>816</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>reviewed_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>4</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>reviewed_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>reviewed_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>reviewed_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>reviewed_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>528</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>reviewed_date_sid &lt;&gt; 0</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>count_reviewed_invoices 1</send_true_to>
    <send_false_to>count_reviewed_invoices 0</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <operator>AND</operator>
            <leftvalue>reviewed_date_sid</leftvalue>
            <function>&lt;></function>
            <rightvalue/>
            <value>
              <name>constant</name>
              <type>Integer</type>
              <text>0</text>
              <length>-1</length>
              <precision>0</precision>
              <isnull>N</isnull>
              <mask>####0;-####0</mask>
            </value>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1056</yloc>
    </GUI>
  </transform>
  <transform>
    <name>reviser_historic_team</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>reviser_historic_team_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <default>1</default>
        <rename>reviser_historic_team_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_teams</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1088</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>reviser_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>reviser_id</name>
        <field>id</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>reviser_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_users_erp</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>960</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>sap_invoice_numbers_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>Y</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>sap_invoice_number</name>
        <field>sap_invoice_number</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>sap_invoice_number_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_sap_invoice_numbers</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1104</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>state_date_sid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>2</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>state_date_day</name>
        <field>date</field>
      </key>
      <key>
        <condition>=</condition>
        <name>state_date_hour</name>
        <field>hour</field>
      </key>
      <key>
        <condition>=</condition>
        <name>state_date_15min</name>
        <field>minute15</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>state_date_sid</rename>
        <name>sid</name>
      </value>
      <schema>${L4_SCHEMA}${PIPE_SCHEMA}</schema>
      <table>dim_time_15min</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>640</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>state_sid 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>0</cache_size>
    <cache>Y</cache>
    <connection>L4</connection>
    <cache_load_all>N</cache_load_all>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <name>state</name>
        <field>state</field>
      </key>
      <value>
        <type>Integer</type>
        <rename>state_sid</rename>
        <name>dwh_sid</name>
      </value>
      <schema>${L4_SCHEMA}_${BAUS_ERP_SCHEMA}</schema>
      <table>dim_invoice_states</table>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1248</xloc>
      <yloc>304</yloc>
    </GUI>
  </transform>
  <transform>
    <name>trash should not have rows</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>656</xloc>
      <yloc>2032</yloc>
    </GUI>
  </transform>
  <transform>
    <name>truncate table restart sid</name>
    <type>ExecSql</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <arguments>
</arguments>
    <connection>L4</connection>
    <execute_each_row>N</execute_each_row>
    <set_params>N</set_params>
    <quoteString>N</quoteString>
    <replace_variables>Y</replace_variables>
    <single_statement>N</single_statement>
    <sql>truncate table ${L4_SCHEMA}_${BAUS_ERP_SCHEMA}.fact_invoice_clearances;
ALTER SEQUENCE ${L4_SCHEMA}_${BAUS_ERP_SCHEMA}.fact_invoice_clearances_dwh_sid_seq RESTART WITH 1;</sql>
    <attributes/>
    <GUI>
      <xloc>144</xloc>
      <yloc>48</yloc>
    </GUI>
  </transform>
  <transform>
    <name>union</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1440</yloc>
    </GUI>
  </transform>
  <transform>
    <name>union 2</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>432</xloc>
      <yloc>1872</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes>
    <group>
      <name>explorerState</name>
    </group>
  </attributes>
</pipeline>
